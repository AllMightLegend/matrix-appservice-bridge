<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: Bridge</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: Bridge</h1>

    




<section>

<header>
    
        <h2>
        Bridge
        </h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    <h4 class="name" id="Bridge"><span class="type-signature"></span>new Bridge<span class="signature">(opts)</span><span class="type-signature"></span></h4>

    











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>opts</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Options to pass to the bridge
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>registration</code></td>
            

            <td class="type">
            
                
<span class="param-type">AppServiceRegistration</span>
|

<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Application service
registration object or path to the registration file.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>homeserverUrl</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The base HS url</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>domain</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The domain part for user_ids and room aliases
e.g. "bar" in "@foo:bar".</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>controller</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The controller logic for the bridge.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>onEvent</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Bridge.html#~onEvent">Bridge~onEvent</a></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Function. Called when
an event has been received from the HS.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>onUserQuery</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Bridge.html#~onUserQuery">Bridge~onUserQuery</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Function. If supplied,
the bridge will invoke this function when queried via onUserQuery. If
not supplied, no users will be provisioned on user queries. Provisioned users
will automatically be stored in the associated <code>userStore</code>.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>onAliasQuery</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Bridge.html#~onAliasQuery">Bridge~onAliasQuery</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Function. If supplied,
the bridge will invoke this function when queried via onAliasQuery. If
not supplied, no rooms will be provisioned on alias queries. Provisioned rooms
will automatically be stored in the associated <code>roomStore</code>.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>onLog</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Bridge.html#~onLog">Bridge~onLog</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Function. Invoked when
logging. Defaults to a function which logs to the console.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>roomStore</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="RoomBridgeStore.html">RoomBridgeStore</a></span>
|

<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">The room store instance to
use, or the path to the room .db file to load. A database will be created if
this is not specified.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>userStore</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="UserBridgeStore.html">UserBridgeStore</a></span>
|

<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">The user store instance to
use, or the path to the user .db file to load. A database will be created if
this is not specified.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>suppressEcho</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">True to stop receiving onEvent callbacks
for events which were sent by a bridge user. Default: true.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>clientFactory</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="ClientFactory.html">ClientFactory</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">The client factory instance to
use. If not supplied, one will be created.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>queue</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Options for the onEvent queue. When the bridge
receives an incoming transaction, it needs to asyncly query the data store for
contextual info before calling onEvent. A queue is used to keep the onEvent
calls consistent with the arrival order from the incoming transactions.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>type</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">The type of queue to use when feeding through
to <a href="Bridge.html#~onEvent">Bridge~onEvent</a>. One of: "none", single", "per_room". If "none",
events are fed through as soon as contextual info is obtained, which may result
in out of order events but stops HOL blocking. If "single", onEvent calls will
be in order but may be slower due to HOL blocking. If "per_room", a queue per
room ID is made which reduces the impact of HOL blocking to be scoped to a room.
Default: "single".</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>perRequest</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">True to only feed through the next
event after the request object in the previous call succeeds or fails. It is
<b>vital</b> that you consistently resolve/reject the request if this is 'true',
else you will not get any further events from this queue. To aid debugging this,
consider setting a delayed listener on the request factory. If false, the mere
invockation of onEvent is enough to trigger the next event in the queue.
You probably want to set this to 'true' if your <a href="Bridge.html#~onEvent">Bridge~onEvent</a> is
performing async operations where ordering matters (e.g. messages). Default: false.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line70">line 70</a>
    </li></ul></dd>
    

    

    

    
</dl>
















    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="getBot"><span class="type-signature"></span>getBot<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="AppServiceBot.html">AppServiceBot</a>}</span></h4>

    



<div class="description">
    Get the AS bot instance.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line245">line 245</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="AppServiceBot.html">AppServiceBot</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="getIntent"><span class="type-signature"></span>getIntent<span class="signature">(userId<span class="signature-attributes">nullable</span>, request<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="Intent.html">Intent</a>}</span></h4>

    



<div class="description">
    Retrieve an Intent instance for the specified user ID. If no ID is given, an
instance for the bot itself is returned.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                
                    &lt;nullable><br>
                

                
                </td>
            

            

            <td class="description last">The user ID to get an Intent for.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>request</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Request.html">Request</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional. The request instance to tie the MatrixClient
instance to. Useful for logging contextual request IDs.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line257">line 257</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    The intent instance
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Intent.html">Intent</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="getIntentFromLocalpart"><span class="type-signature"></span>getIntentFromLocalpart<span class="signature">(localpart<span class="signature-attributes">nullable</span>, request<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="Intent.html">Intent</a>}</span></h4>

    



<div class="description">
    Retrieve an Intent instance for the specified user ID localpart. This <i>must
be the complete user localpart</i>.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>localpart</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                
                    &lt;nullable><br>
                

                
                </td>
            

            

            <td class="description last">The user ID localpart to get an Intent for.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>request</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Request.html">Request</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional. The request instance to tie the MatrixClient
instance to. Useful for logging contextual request IDs.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line277">line 277</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    The intent instance
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Intent.html">Intent</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="getRequestFactory"><span class="type-signature"></span>getRequestFactory<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="RequestFactory.html">RequestFactory</a>}</span></h4>

    



<div class="description">
    Retrieve the request factory used to create incoming requests.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line237">line 237</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="RequestFactory.html">RequestFactory</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="getRoomStore"><span class="type-signature"></span>getRoomStore<span class="signature">()</span><span class="type-signature"> &rarr; (nullable) {<a href="RoomBridgeStore.html">RoomBridgeStore</a>}</span></h4>

    



<div class="description">
    Retrieve a connected room store instance.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line221">line 221</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    The connected instance ready for querying.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="RoomBridgeStore.html">RoomBridgeStore</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="getUserStore"><span class="type-signature"></span>getUserStore<span class="signature">()</span><span class="type-signature"> &rarr; (nullable) {<a href="UserBridgeStore.html">UserBridgeStore</a>}</span></h4>

    



<div class="description">
    Retrieve a connected user store instance.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line229">line 229</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    The connected instance ready for querying.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="UserBridgeStore.html">UserBridgeStore</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="provisionUser"><span class="type-signature"></span>provisionUser<span class="signature">(matrixUser, provisionedUser)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    



<div class="description">
    Provision a user on the homeserver.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>matrixUser</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="MatrixUser.html">MatrixUser</a></span>


            
            </td>

            

            

            <td class="description last">The virtual user to be provisioned.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>provisionedUser</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Bridge.html#~ProvisionedUser">Bridge~ProvisionedUser</a></span>


            
            </td>

            

            

            <td class="description last">Provisioning information.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line289">line 289</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Resolved when provisioned.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="run"><span class="type-signature"></span>run<span class="signature">(port, config, appServiceInstance<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    



<div class="description">
    Run the bridge (start listening)
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>port</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The port to listen on.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>config</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Configuration options</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>appServiceInstance</code></td>
            

            <td class="type">
            
                
<span class="param-type">AppService</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">The AppService instance to attach to.
If not provided, one will be created.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line130">line 130</a>
    </li></ul></dd>
    

    

    

    
</dl>
















        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                
<h4 class="name" id="~BridgeContext">BridgeContext</h4>






    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>senders</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Data models on senders of this event
                <h6>Properties</h6>

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>matrix</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="MatrixUser.html">MatrixUser</a></span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last">The sender of this event</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remote</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="RemoteUser.html">RemoteUser</a></span>


            
            </td>

            
                <td class="attributes">
                

                
                    &lt;nullable><br>
                
                </td>
            

            

            <td class="description last">The first linked remote sender: remotes[0]</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remotes</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;<a href="RemoteUser.html">RemoteUser</a>></span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last">The linked remote senders</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>targets</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Data models on targets (e.g. state_key in
m.room.member) of this event.
                <h6>Properties</h6>

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>matrix</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="MatrixUser.html">MatrixUser</a></span>


            
            </td>

            
                <td class="attributes">
                

                
                    &lt;nullable><br>
                
                </td>
            

            

            <td class="description last">The target of this event if applicable.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remote</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="RemoteUser.html">RemoteUser</a></span>


            
            </td>

            
                <td class="attributes">
                

                
                    &lt;nullable><br>
                
                </td>
            

            

            <td class="description last">The first linked remote target: remotes[0]</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remotes</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;<a href="RemoteUser.html">RemoteUser</a>></span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last">The linked remote targets</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rooms</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Data models on rooms concerning this event.
                <h6>Properties</h6>

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>matrix</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="MatrixRoom.html">MatrixRoom</a></span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last">The room for this event.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remote</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="RemoteRoom.html">RemoteRoom</a></span>


            
            </td>

            
                <td class="attributes">
                

                
                    &lt;nullable><br>
                
                </td>
            

            

            <td class="description last">The first linked remote room: remotes[0]</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remotes</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;<a href="RemoteRoom.html">RemoteRoom</a>></span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last">The linked remote rooms for this event</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line550">line 550</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
                

    

    <h4 class="name" id="~onAliasQuery"><span class="type-signature"></span>onAliasQuery<span class="signature">(alias, aliasLocalpart)</span><span class="type-signature"> &rarr; {<a href="Bridge.html#~ProvisionedRoom">Bridge~ProvisionedRoom</a>|Promise.&lt;<a href="Bridge.html#~ProvisionedRoom">Bridge~ProvisionedRoom</a>, Error>}</span></h4>

    



<div class="description">
    Invoked when the bridge receives an alias query from the homeserver. Supports
both sync return values and async return values via promises.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>alias</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The alias queried.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>aliasLocalpart</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The parsed localpart of the alias.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line608">line 608</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Reject the promise / return null to not provision the room. Resolve the
promise / return a <a href="Bridge.html#~ProvisionedRoom">Bridge~ProvisionedRoom</a> object to provision the room.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Bridge.html#~ProvisionedRoom">Bridge~ProvisionedRoom</a></span>
|

<span class="param-type">Promise.&lt;<a href="Bridge.html#~ProvisionedRoom">Bridge~ProvisionedRoom</a>, Error></span>


    </dd>
</dl>

    


    <h5>Example</h5>
    
    <pre class="prettyprint"><code>new Bridge({
  controller: {
    onAliasQuery: function(alias, aliasLocalpart) {
      return {
        creationOpts: {
          room_alias_name: aliasLocalpart, // IMPORTANT: must be set to make the link
          name: aliasLocalpart,
          topic: "Auto-generated bridged room"
        }
      };
    }
  }
});</code></pre>



            
                

    

    <h4 class="name" id="~onEvent"><span class="type-signature"></span>onEvent<span class="signature">(request, context)</span><span class="type-signature"></span></h4>

    



<div class="description">
    Invoked when the bridge receives an event from the homeserver.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>request</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Request.html">Request</a></span>


            
            </td>

            

            

            <td class="description last">The request to resolve or reject depending on the
outcome of this request. The 'data' attached to this Request is the raw event
JSON received (accessed via <code>request.getData()</code>)</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>context</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Bridge.html#~BridgeContext">Bridge~BridgeContext</a></span>


            
            </td>

            

            

            <td class="description last">Context for this event, including
instantiated client instances.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line633">line 633</a>
    </li></ul></dd>
    

    

    

    
</dl>
















            
                

    

    <h4 class="name" id="~onLog"><span class="type-signature"></span>onLog<span class="signature">(line, isError)</span><span class="type-signature"></span></h4>

    



<div class="description">
    Invoked when the bridge is attempting to log something.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>line</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The text to be logged.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>isError</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            

            

            <td class="description last">True if this line should be treated as an error msg.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line643">line 643</a>
    </li></ul></dd>
    

    

    

    
</dl>
















            
                

    

    <h4 class="name" id="~onUserQuery"><span class="type-signature"></span>onUserQuery<span class="signature">(matrixUser)</span><span class="type-signature"> &rarr; {<a href="Bridge.html#~ProvisionedUser">Bridge~ProvisionedUser</a>|Promise.&lt;<a href="Bridge.html#~ProvisionedUser">Bridge~ProvisionedUser</a>, Error>}</span></h4>

    



<div class="description">
    Invoked when the bridge receives a user query from the homeserver. Supports
both sync return values and async return values via promises.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>matrixUser</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="MatrixUser.html">MatrixUser</a></span>


            
            </td>

            

            

            <td class="description last">The matrix user queried. Use <code>getId()</code>
to get the user ID.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line584">line 584</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Reject the promise / return null to not provision the user. Resolve the
promise / return a <a href="Bridge.html#~ProvisionedUser">Bridge~ProvisionedUser</a> object to provision the user.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Bridge.html#~ProvisionedUser">Bridge~ProvisionedUser</a></span>
|

<span class="param-type">Promise.&lt;<a href="Bridge.html#~ProvisionedUser">Bridge~ProvisionedUser</a>, Error></span>


    </dd>
</dl>

    


    <h5>Example</h5>
    
    <pre class="prettyprint"><code>new Bridge({
  controller: {
    onUserQuery: function(matrixUser) {
      var remoteUser = new RemoteUser("some_remote_id");
      return {
        name: matrixUser.localpart + " (Bridged)",
        url: "http://someurl.com/pic.jpg",
        user: remoteUser
      };
    }
  }
});</code></pre>



            
                
<h4 class="name" id="~ProvisionedRoom">ProvisionedRoom</h4>






    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>creationOpts</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last">Room creation options to use when creating the
room. Required.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remote</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="RemoteRoom.html">RemoteRoom</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                
                </td>
            

            

            <td class="description last">The remote room to link to the provisioned room.</td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line576">line 576</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
                
<h4 class="name" id="~ProvisionedUser">ProvisionedUser</h4>






    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                
                </td>
            

            

            <td class="description last">The display name to set for the provisioned user.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>url</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                
                </td>
            

            

            <td class="description last">The avatar URL to set for the provisioned user.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>remote</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="RemoteUser.html">RemoteUser</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                
                </td>
            

            

            <td class="description last">The remote user to link to the provisioned user.</td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="bridge.js.html">bridge.js</a>, <a href="bridge.js.html#line568">line 568</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AppServiceBot.html">AppServiceBot</a></li><li><a href="Bridge.html">Bridge</a></li><li><a href="BridgeStore.html">BridgeStore</a></li><li><a href="Cli.html">Cli</a></li><li><a href="ClientFactory.html">ClientFactory</a></li><li><a href="ConfigValidator.html">ConfigValidator</a></li><li><a href="Intent.html">Intent</a></li><li><a href="MatrixRoom.html">MatrixRoom</a></li><li><a href="MatrixUser.html">MatrixUser</a></li><li><a href="RemoteRoom.html">RemoteRoom</a></li><li><a href="RemoteUser.html">RemoteUser</a></li><li><a href="Request.html">Request</a></li><li><a href="RequestFactory.html">RequestFactory</a></li><li><a href="RoomBridgeStore.html">RoomBridgeStore</a></li><li><a href="UserBridgeStore.html">UserBridgeStore</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Wed Jan 27 2016 13:20:47 GMT+0000 (GMT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>